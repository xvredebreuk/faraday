
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Faraday" name="description"/>
<meta content="Faradaysec" name="author"/>
<link href="https://faradaysec.com/Basic-plugin-development/" rel="canonical"/>
<link href="../Scripts/" rel="prev"/>
<link href="../Contact-us/" rel="next"/>
<link href="../images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.4.3, mkdocs-material-9.1.14" name="generator"/>
<title>Plugin Development - Faraday</title>
<link href="../assets/stylesheets/main.85bb2934.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Rubik:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Rubik";--md-code-font:"Roboto Mono"}</style>
<link href="../stylesheets/faraday_doc.css" rel="stylesheet"/>
<link href="../stylesheets/hover.css" rel="stylesheet"/>
<link href="https://unpkg.com/mermaid@8.5.1/dist/mermaid.css" rel="stylesheet"/>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script id="__analytics">function __md_analytics(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-46485512-11","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");ga("send","event","feedback","click",t,e),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){ga("send","pageview",e.pathname)})});var e=document.createElement("script");e.async=!0,e.src="https://www.google-analytics.com/analytics.js",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
</head>
<body dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#configure-custom-plugins">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Faraday" class="md-header__button md-logo" data-md-component="logo" href=".." title="Faraday">
<img alt="logo" src="../images/logo.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Faraday
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Plugin Development
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/infobyte/faraday" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</div>
<div class="md-source__repository">
    infobyte/faraday
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Faraday" class="md-nav__button md-logo" data-md-component="logo" href=".." title="Faraday">
<img alt="logo" src="../images/logo.svg"/>
</a>
    Faraday
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/infobyte/faraday" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</div>
<div class="md-source__repository">
    infobyte/faraday
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Home
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
          Home
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        Home
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
          Changelogs
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_2">
<span class="md-nav__icon md-icon"></span>
          Changelogs
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../RELEASE/">
        Faraday Server
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          V4
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          V4
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Workspaces-v4/">
        Workspaces
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Activity-Dashboard/">
        Activity Dashboard
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Vulns-v4/">
        Vulnerability Management
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Vulnerability-Templates-KB/">
        Vulnerability KB
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Assets-and-Services-v4/">
        Assets and Services
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
          Reports
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_6">
<span class="md-nav__icon md-icon"></span>
          Reports
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Report-v4/">
        What is Report
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../How-to-build-your-template/">
        How to Build Your Own Template
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Jinja2-context/">
        Jinja2 Context
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../import/">
        Importing
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Planner/">
        Planner
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
          Automation
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_9_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_9">
<span class="md-nav__icon md-icon"></span>
          Automation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../agents-v4/">
        Agents
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Scheduling/">
        Scheduler
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Pipelines/">
        Pipelines and jobs
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../First-Steps/">
        First Steps
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Dashboard-v4/">
        Dashboard
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Custom-Fields-v4/">
        Custom Attributes
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Installing Faraday
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Installing Faraday
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Install-guide-Linux/">
        Linux
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Install-guide-Redhat-8/">
        RedHat 8/Centos
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Install-guide-Docker/">
        Docker
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Install-guide-community/">
        Community
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
          Advanced
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_5">
<span class="md-nav__icon md-icon"></span>
          Advanced
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Install-guide-Advanced/">
        Advanced Install
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Remote-PostgreSQL/">
        Remote PostgreSQL
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../NGINX-Setup/">
        NGINX (SSL Config)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Install-guide-Troubleshooting/">
        Troubleshooting
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Update/">
        Update
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Backup-v4/">
        Backup
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Getting-started/">
        First Steps
      </a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Faraday Cli
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          Faraday Cli
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../faraday-cli/">
        Faraday cli
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Settings-v4/">
        Settings
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Using Faraday
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
          Using Faraday
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Architecture/">
        Arch
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
          API
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_2">
<span class="md-nav__icon md-icon"></span>
          API
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api-swagger/">
        Openapi
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../API-Server/">
        API Server
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../API-Token/">
        API Token
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
          Faraday Manage
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_3">
<span class="md-nav__icon md-icon"></span>
          Faraday Manage
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Faraday-Manage/">
        Faraday Manage
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Faraday-Manage-Settings-v4/">
        Faraday Manage Settings
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
          Extras
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_4">
<span class="md-nav__icon md-icon"></span>
          Extras
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Burp-proxy-extender/">
        Burp
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../beef/">
        Beef
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
          Integrations
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_5">
<span class="md-nav__icon md-icon"></span>
          Integrations
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../integration-gitlab/">
        GitLab
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../integration-jira/">
        Jira
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../integration-solarwinds/">
        SolarWinds
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../integration-servicenow/">
        ServiceNow
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
          Configuration
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_6">
<span class="md-nav__icon md-icon"></span>
          Configuration
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../LDAP/">
        LDAP
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../LDAP-OKTA/">
        LDAP with OKTA
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_6_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_6_3" id="__nav_7_6_3_label" tabindex="0">
          SSO
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_6_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_7_6_3">
<span class="md-nav__icon md-icon"></span>
          SSO
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../SAML/">
        Faraday configuration
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../SAML-Auth0/">
        Auth0 integration
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../SAML-Google/">
        Google integration
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../SAML-Okta/">
        Okta integration
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../2-Factor-Authentication/">
        2nd Factor
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Scripts/">
        Scripts
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_7_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_8" id="__nav_7_8_label" tabindex="0">
          For Developers
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_7_8_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_8">
<span class="md-nav__icon md-icon"></span>
          For Developers
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Plugin Development
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Plugin Development
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#configure-custom-plugins">
    Configure Custom Plugins
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#create-plugin-structure">
    Create Plugin structure
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#plugin-code">
    Plugin code
  </a>
<nav aria-label="Plugin code" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#plugin-classes">
    Plugin classes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#file-plugins">
    File Plugins
  </a>
<nav aria-label="File Plugins" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#pluginbyextension">
    PluginByExtension:
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pluginxmlformat">
    PluginXMLFormat:
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pluginjsonformat">
    PluginJsonFormat:
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pluginmultilinejsonformat">
    PluginMultiLineJsonFormat:
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#plugincsvformat">
    PluginCSVFormat:
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pluginzipformat">
    PluginZipFormat:
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#generating-data">
    Generating data
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#command-plugins">
    Command Plugins
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#full-example">
    Full Example
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#test-and-debug">
    Test and Debug
  </a>
<nav aria-label="Test and Debug" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#test-plugins">
    Test Plugins
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#logging">
    Logging
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          FAQs
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
          FAQs
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Contact-us/">
        Contact Us
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../FAQ/">
        FAQs
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Plugin-List-v4/">
        Supported-Plugins
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Troubleshooting/">
        Troubleshooting
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#configure-custom-plugins">
    Configure Custom Plugins
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#create-plugin-structure">
    Create Plugin structure
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#plugin-code">
    Plugin code
  </a>
<nav aria-label="Plugin code" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#plugin-classes">
    Plugin classes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#file-plugins">
    File Plugins
  </a>
<nav aria-label="File Plugins" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#pluginbyextension">
    PluginByExtension:
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pluginxmlformat">
    PluginXMLFormat:
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pluginjsonformat">
    PluginJsonFormat:
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pluginmultilinejsonformat">
    PluginMultiLineJsonFormat:
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#plugincsvformat">
    PluginCSVFormat:
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pluginzipformat">
    PluginZipFormat:
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#generating-data">
    Generating data
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#command-plugins">
    Command Plugins
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#full-example">
    Full Example
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#test-and-debug">
    Test and Debug
  </a>
<nav aria-label="Test and Debug" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#test-plugins">
    Test Plugins
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#logging">
    Logging
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1>Plugin Development</h1>
<p>In this guide we are going to learn how to develop a new plugin for Faraday.</p>
<h2 id="configure-custom-plugins">Configure Custom Plugins<a class="headerlink" href="#configure-custom-plugins" title="Permanent link">¶</a></h2>
<p>To add custom plugins in faraday, you first need to run this command:</p>
<div class="highlight"><pre><span></span><code>faraday-manage settings -a update reports
</code></pre></div>
<hr/>
<h2 id="create-plugin-structure">Create Plugin structure<a class="headerlink" href="#create-plugin-structure" title="Permanent link">¶</a></h2>
<p>Create the folder <code>new_plugin</code> inside the <code>custom_plugins</code> folder and add the following files inside the <code>new_plugin</code> folder:</p>
<p>Plugin Structure:</p>
<div class="highlight"><pre><span></span><code>new_plugin/
    __init__.py # leave this file empty
    plugin.py
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please respect both file names:
<code>__init__.py</code> and <code>plugin.py</code></p>
</div>
<hr/>
<h2 id="plugin-code">Plugin code<a class="headerlink" href="#plugin-code" title="Permanent link">¶</a></h2>
<p>There are two types of plugins:</p>
<ul>
<li>File plugins (plugins that process the contents of a file)</li>
<li>Command plugins (plugins that process the execution of a command)</li>
</ul>
<p>A faraday plugin can be either or both of these types.
For example the ping plugin only process the execution of the command, but the nmap command supports both the xml generated by nmap or process the execution of nmap.</p>
<p>In your <code>plugin.py</code> file you must provide a function called <code>createPlugin</code> for the plugin manager to instantiate the plugin</p>
<div class="highlight"><pre><span></span><code>def createPlugin(ignore_info=False, hostname_resolution=True):
    return YourPluginClass(ignore_info=ignore_info)
</code></pre></div>
<h4 id="plugin-classes">Plugin classes<a class="headerlink" href="#plugin-classes" title="Permanent link">¶</a></h4>
<p><code>PluginBase</code> is the base class. </p>
<p>For File plugins we provide all this classes.
But you can add other by creating a subclass of <code>PluginByExtension</code></p>
<ul>
<li>PluginBase</li>
<li>PluginByExtension<ul>
<li>PluginXMLFormat</li>
<li>PluginJsonFormat</li>
<li>PluginMultiLineJsonFormat</li>
<li>PluginCSVFormat</li>
<li>PluginZipFormat</li>
</ul>
</li>
</ul>
<p>For Command plugins only you must inherit from PluginBase</p>
<p>Your plugin class <code>__init__</code> method must define the <code>id</code>, that will be the identifier of your plugin.</p>
<p>Here's an example of the Ping tool plugin:
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CmdPingPlugin</span><span class="p">(</span><span class="n">PluginBase</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="hll">            <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="s2">"ping"</span>
</span>            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"Ping"</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plugin_version</span> <span class="o">=</span> <span class="s2">"0.0.1"</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="s2">"1.0.0"</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_command_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">'^(sudo ping|ping|sudo ping6|ping6)\s+.*?'</span><span class="p">)</span>
</code></pre></div></p>
<p>Beware that it must be unique, you can list all the plugins identifiers with this command: <code>faraday-plugins list-plugins</code></p>
<h4 id="file-plugins">File Plugins<a class="headerlink" href="#file-plugins" title="Permanent link">¶</a></h4>
<p>Each of the subclasses for File plugins provide a different way for the plugin to detect if it can process the file</p>
<h5 id="pluginbyextension">PluginByExtension:<a class="headerlink" href="#pluginbyextension" title="Permanent link">¶</a></h5>
<p>This class adds the functionality for identify a file by its extension by setting the attribute <code>extension</code>.</p>
<p>It can be one extension (<code>".xml"</code>) or a list (<code>['.xml', '.xxx']</code>) if your file can have multiple extensions.</p>
<p>You never inherit directly from this class in a plugin but from some of its subclasses that are more specific.</p>
<div class="highlight"><pre><span></span><code>class ExampleXMLTool(PluginByExtension):

        def __init__(self):
            super().__init__()
            self.extension = ".xml"
</code></pre></div>
<h5 id="pluginxmlformat">PluginXMLFormat:<a class="headerlink" href="#pluginxmlformat" title="Permanent link">¶</a></h5>
<p>Use this class if the plugin generates vulnerabilities from a xml file.</p>
<p>If your report has xml format but a different extension (like nessus), remember to define the <code>extension</code> attribute</p>
<p>To identify the file set in the <code>identifier_tag</code> attribute the main tag of the xml (ScanGroup in the example), it also can be one tag or a list of tags.</p>
<p>You can also set the <code>identifier_tag_attributes</code> attribute, it is a set of attributes that the main tag must have.</p>
<p>This is used to be more specific for example if the main tag is too generic and the xml of other plugin has the same one. </p>
<p>Example XML
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="nt">&lt;ScanGroup</span><span class="w"> </span><span class="na">ExportedOn=</span><span class="s">"2021-11-05T11:18:57.673843"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Scan&gt;</span>
<span class="w">    </span><span class="nt">&lt;/Scan&gt;</span>
<span class="nt">&lt;/ScanGroup&gt;</span>
</code></pre></div></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>
<span class="kn">from</span> <span class="nn">faraday_plugins.plugins.plugin</span> <span class="kn">import</span> <span class="n">PluginXMLFormat</span>
<span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="k">as</span> <span class="nn">ET</span>

<span class="k">class</span> <span class="nc">ExampleToolXmlParser</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xml_output</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vulns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_xml</span><span class="p">(</span><span class="n">xml_output</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">parse_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xml_output</span><span class="p">):</span>
        <span class="n">vulns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">xml_output</span><span class="p">)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">iterfind</span><span class="p">(</span><span class="s1">'details/item'</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">ip</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'ip'</span><span class="p">)</span>
            <span class="n">os</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'os'</span><span class="p">)</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'uri'</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
            <span class="n">hostname</span> <span class="o">=</span> <span class="p">[</span><span class="n">url</span><span class="o">.</span><span class="n">netloc</span><span class="p">]</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">path</span>
            <span class="k">if</span> <span class="n">url</span><span class="o">.</span><span class="n">scheme</span> <span class="o">==</span> <span class="s1">'https'</span><span class="p">:</span>
                <span class="n">port</span> <span class="o">=</span> <span class="mi">443</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">port</span> <span class="o">=</span> <span class="mi">80</span>
            <span class="n">issue</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'issue'</span><span class="p">)</span>
            <span class="n">severity</span> <span class="o">=</span> <span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'severity'</span><span class="p">)</span>
            <span class="n">issue_text</span> <span class="o">=</span> <span class="n">issue</span><span class="o">.</span><span class="n">text</span>
            <span class="n">vuln</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'ip'</span><span class="p">:</span> <span class="n">ip</span><span class="p">,</span> <span class="s1">'uri'</span><span class="p">:</span> <span class="n">uri</span><span class="p">,</span> <span class="s1">'os'</span><span class="p">:</span> <span class="n">os</span><span class="p">,</span>
                    <span class="s1">'hostname'</span><span class="p">:</span> <span class="n">hostname</span><span class="p">,</span> <span class="s1">'port'</span><span class="p">:</span> <span class="n">port</span><span class="p">,</span> <span class="s1">'path'</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span>
                    <span class="s1">'issue_text'</span><span class="p">:</span> <span class="n">issue_text</span><span class="p">,</span> <span class="s1">'severity'</span><span class="p">:</span> <span class="n">severity</span><span class="p">}</span>
            <span class="n">vulns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vuln</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">vulns</span>


<span class="k">class</span> <span class="nc">ExampleToolPlugin</span><span class="p">(</span><span class="n">PluginXMLFormat</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">identifier_tag</span> <span class="o">=</span> <span class="s2">"example_tool"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="s2">"example_tool"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"Name of the tool"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugin_version</span> <span class="o">=</span> <span class="s2">"0.0.1"</span>

    <span class="k">def</span> <span class="nf">parseOutputString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ExampleToolXmlParser</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">vuln</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">vulns</span><span class="p">:</span>
            <span class="n">h_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createAndAddHost</span><span class="p">(</span><span class="n">vuln</span><span class="p">[</span><span class="s1">'ip'</span><span class="p">],</span> <span class="n">vuln</span><span class="p">[</span><span class="s1">'os'</span><span class="p">],</span> <span class="n">hostnames</span><span class="o">=</span><span class="n">vuln</span><span class="p">[</span><span class="s1">'hostname'</span><span class="p">])</span>
            <span class="n">s_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createAndAddServiceToHost</span><span class="p">(</span><span class="n">h_id</span><span class="p">,</span> <span class="s1">'webserver'</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="s1">'tcp'</span><span class="p">,</span> <span class="n">ports</span><span class="o">=</span><span class="n">vuln</span><span class="p">[</span><span class="s1">'port'</span><span class="p">])</span>
            <span class="n">v_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createAndAddVulnWebToService</span><span class="p">(</span><span class="n">h_id</span><span class="p">,</span> <span class="n">s_id</span><span class="p">,</span> <span class="n">vuln</span><span class="p">[</span><span class="s1">'issue_text'</span><span class="p">],</span> <span class="n">severity</span><span class="o">=</span><span class="n">vuln</span><span class="p">[</span><span class="s1">'severity'</span><span class="p">],</span>
                                                    <span class="n">path</span><span class="o">=</span><span class="n">vuln</span><span class="p">[</span><span class="s1">'path'</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">createPlugin</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ExampleToolPlugin</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
<h5 id="pluginjsonformat">PluginJsonFormat:<a class="headerlink" href="#pluginjsonformat" title="Permanent link">¶</a></h5>
<p>Use this class if the plugin generates vulnerabilities from a json file.</p>
<p>If yor report has json format but a different extension (not .json), remember to define the <code>extension</code> attribute</p>
<p>To identify the file set in the <code>json_keys</code> attribute a set with some identifiers keys of the json object</p>
<p>Example JSON
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some name"</span><span class="p">,</span>
<span class="w">  </span><span class="nt">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"host1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"host2"</span><span class="p">],</span>
<span class="w">  </span><span class="nt">"other_field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some value"</span>
<span class="p">}</span>
</code></pre></div></p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ExampleJsonTool</span><span class="p">(</span><span class="n">PluginJsonFormat</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ignore_info</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ignore_info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_keys</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'hosts'</span><span class="p">}</span>
</code></pre></div>
<h5 id="pluginmultilinejsonformat">PluginMultiLineJsonFormat:<a class="headerlink" href="#pluginmultilinejsonformat" title="Permanent link">¶</a></h5>
<p>Is the same as <code>PluginJsonFormat</code> but use it when the file has multiple lines and every line is a json.</p>
<p>Example JSON
<div class="highlight"><pre><span></span><code>{ "name": "some name", "hosts": ["host1", "host2"],"other_field": "some value"}
{ "name": "other name", "hosts": ["host3", "host4"],"other_field": "other value"}
</code></pre></div></p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ExampleMultipleJsonTool</span><span class="p">(</span><span class="n">PluginMultiLineJsonFormat</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ignore_info</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ignore_info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_keys</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'hosts'</span><span class="p">}</span>
</code></pre></div>
<h5 id="plugincsvformat">PluginCSVFormat:<a class="headerlink" href="#plugincsvformat" title="Permanent link">¶</a></h5>
<p>Use this class if the plugin generates vulnerabilities from a csv file.</p>
<p>If yor report has csv format but a different extension (not .csv), remember to define the <code>extension</code> attribute</p>
<p>To identify the file set in the <code>csv_headers</code> attribute a set with some identifiers headers of the csv object</p>
<p>Example CSV
<div class="highlight"><pre><span></span><code>name,ip,os
host1,10.10.10.10,windows
host2,10.10.10.11,linux
</code></pre></div></p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ExampleCSVTool</span><span class="p">(</span><span class="n">PluginCSVFormat</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ignore_info</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ignore_info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_keys</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'ip'</span><span class="p">}</span>
</code></pre></div>
<h5 id="pluginzipformat">PluginZipFormat:<a class="headerlink" href="#pluginzipformat" title="Permanent link">¶</a></h5>
<p>Use this class if the plugin generates vulnerabilities from a zip file.</p>
<p>If yor report has csv format but a different extension (not .zip), remember to define the <code>extension</code> attribute</p>
<p>To identify the file set in the <code>files_list</code> attribute a set with some file names inside the zip file.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ExampleJsonTool</span><span class="p">(</span><span class="n">PluginZipFormat</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ignore_info</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ignore_info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files_list</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'file1.txt'</span><span class="p">,</span> <span class="s1">'file2.txt'</span><span class="p">}</span>
</code></pre></div>
<h5 id="generating-data">Generating data<a class="headerlink" href="#generating-data" title="Permanent link">¶</a></h5>
<p>The <code>PluginBase</code> class give you all the main methods to create hosts, services and vulnerabilities</p>
<p>After you parse the data you will need to create the objects with the information to send to faraday.
This are the main methods</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">createAndAddHost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">os</span><span class="o">=</span><span class="s2">"unknown"</span><span class="p">,</span> <span class="n">hostnames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mac</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scan_template</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">site_name</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span>
                    <span class="n">site_importance</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">risk_score</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">fingerprints</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">fingerprints_software</span><span class="o">=</span><span class="s2">""</span><span class="p">):</span>

<span class="k">def</span> <span class="nf">createAndAddServiceToHost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="s2">"tcp?"</span><span class="p">,</span> <span class="n">ports</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s2">"open"</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">"unknown"</span><span class="p">,</span>
                            <span class="n">description</span><span class="o">=</span><span class="s2">""</span><span class="p">):</span>

<span class="k">def</span> <span class="nf">createAndAddVulnToHost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">vulnerable_since</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> 
                            <span class="n">scan_id</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">pci</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">external_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">run_date</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

<span class="k">def</span> <span class="nf">createAndAddVulnToService</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host_id</span><span class="p">,</span> <span class="n">service_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> 
                            <span class="n">risk</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">external_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">run_date</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

<span class="k">def</span> <span class="nf">createAndAddVulnWebToService</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host_id</span><span class="p">,</span> <span class="n">service_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span>
                                <span class="n">website</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">pname</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span>
                                <span class="n">params</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">external_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">run_date</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</code></pre></div>
<p><code>createAndAddHost</code> and <code>createAndAddServiceToHost</code> will give you a host ID and a service ID.
You need to send those to the create vulnerabilities methods</p>
<p>The main method to parse data and create the vulnerabilities objects is <code>parseOutputString</code>, no mather if is a File or a Command plugin.</p>
<h4 id="command-plugins">Command Plugins<a class="headerlink" href="#command-plugins" title="Permanent link">¶</a></h4>
<p>For command plugins the detection is done via regex.</p>
<p>If the plugin is only for command you inherit from <code>PluginBase</code> if it also will support file detection inherit from the appropriate class for that type of file.</p>
<p>In both cases to detect a command you will need to set the <code>_command_regex</code> attribute with the regex to match the command</p>
<p>Here's an example of the Ping tool plugin:
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CmdPingPlugin</span><span class="p">(</span><span class="n">PluginBase</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="s2">"ping"</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"Ping"</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plugin_version</span> <span class="o">=</span> <span class="s2">"0.0.1"</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="s2">"1.0.0"</span>
<span class="hll">            <span class="bp">self</span><span class="o">.</span><span class="n">_command_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">'^(sudo ping|ping|sudo ping6|ping6)\s+.*?'</span><span class="p">)</span>
</span>
    <span class="k">def</span> <span class="nf">parseOutputString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">"PING ([\w\.-:]+)( |)\(([\w\.:]+)\)"</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">"0 received|unknown host"</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">reg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ip_address</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">hostname</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">createAndAddHost</span><span class="p">(</span><span class="n">ip_address</span><span class="p">,</span> <span class="n">hostnames</span><span class="o">=</span><span class="p">[</span><span class="n">hostname</span><span class="p">])</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_isIPV4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ip</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"."</span><span class="p">))</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></p>
<p>In this case the plugin manager will run the command and send the output to the <code>parseOutputString</code> method.</p>
<p>But if the tool generate an ouput file instead of send the data to stdout you will need to check that the command has the required parameters to do that.</p>
<p>To do that you will need to implement the <code>processCommandString</code> method, by default it will return the command without modifications.</p>
<p>To use output files you will need to set 2 attributes in you plugin: <code>_use_temp_file</code> and <code>_temp_file_extension</code></p>
<p>If <code>_use_temp_file</code> is set the plugin will create a temp file and assign its path to the attribute <code>self._output_file_path</code> of the plugin.</p>
<p>If you need that the temp file has and specific extension use the <code>_temp_file_extension</code> attribute like in the example.</p>
<p>If the <code>_use_temp_file</code> attribute is set the plugin will send te content of that file to <code>parseOutputString()</code>instead of the output of the command.</p>
<p>Here is and extract of the nmap plugin to see how <code>processCommandString</code> will modify the original command and return a new command with the required parameters.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">NmapPlugin</span><span class="p">(</span><span class="n">PluginXMLFormat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Example plugin to parse nmap output.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">identifier_tag</span> <span class="o">=</span> <span class="s2">"nmaprun"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="s2">"Nmap"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"Nmap XML Output Plugin"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugin_version</span> <span class="o">=</span> <span class="s2">"0.0.3"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="s2">"6.40"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">framework_version</span> <span class="o">=</span> <span class="s2">"1.0.0"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_output</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_command_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">'^(sudo nmap|nmap|\.\/nmap)\s+.*?'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_use_temp_file</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_temp_file_extension</span> <span class="o">=</span> <span class="s2">"xml"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xml_arg_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">"^.*(-oX\s*[^\s]+).*$"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addSetting</span><span class="p">(</span><span class="s2">"Scan Technique"</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">"-sS"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">parseOutputString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">processCommandString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">current_path</span><span class="p">,</span> <span class="n">command_string</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Adds the -oX parameter to get xml output to the command string that the</span>
<span class="sd">        user has set.</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">processCommandString</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">current_path</span><span class="p">,</span> <span class="n">command_string</span><span class="p">)</span>
        <span class="n">arg_match</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml_arg_re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">command_string</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">arg_match</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">"(^.*?nmap)"</span><span class="p">,</span>
                          <span class="sa">r</span><span class="s2">"\1 -oX </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output_file_path</span><span class="p">,</span>
                          <span class="n">command_string</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">arg_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                          <span class="sa">r</span><span class="s2">"-oX </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output_file_path</span><span class="p">,</span>
                          <span class="n">command_string</span><span class="p">)</span>
</code></pre></div>
<h4 id="full-example">Full Example<a class="headerlink" href="#full-example" title="Permanent link">¶</a></h4>
<div class="tabbed-set" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio"><label for="__tabbed_1_1">File Plugin from XML</label><div class="tabbed-content"></div>
</input></div>
<p>This is an example of a Faraday Plugin that process a xml report.</p>
<p>In this example we will create a plugin to analyze this XML provided by the output of a tool.</p>
<p><strong>example.xml</strong>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="cp">&lt;?xml version="1.0" ?&gt;</span>
<span class="cp">&lt;!DOCTYPE example_tool&gt;</span>
<span class="nt">&lt;example_tool</span><span class="w"> </span><span class="na">scanstart=</span><span class="s">"Thu Nov  9 15:59:13 2017"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;details&gt;</span>
<span class="w">    </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">id=</span><span class="s">"999979"</span><span class="w"> </span><span class="na">ip=</span><span class="s">"10.23.49.232"</span><span class="w"> </span><span class="na">os=</span><span class="s">"linux"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;uri&gt;</span>http://test.com/example.php<span class="nt">&lt;/uri&gt;</span>
<span class="w">    </span><span class="nt">&lt;issue</span><span class="w"> </span><span class="na">severity=</span><span class="s">"low"</span><span class="nt">&gt;</span>Some<span class="w"> </span>vuln<span class="w"> </span>text<span class="nt">&lt;/issue&gt;</span>
<span class="w">    </span><span class="nt">&lt;/item&gt;</span>
<span class="w">    </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">id=</span><span class="s">"39023023"</span><span class="w"> </span><span class="na">ip=</span><span class="s">"10.232.62.20"</span><span class="w"> </span><span class="na">os=</span><span class="s">"linux"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;uri&gt;</span>http://test.com/login.php<span class="nt">&lt;/uri&gt;</span>
<span class="w">    </span><span class="nt">&lt;issue</span><span class="w"> </span><span class="na">severity=</span><span class="s">"low"</span><span class="nt">&gt;</span>Some<span class="w"> </span>other<span class="w"> </span>text<span class="nt">&lt;/issue&gt;</span>
<span class="w">    </span><span class="nt">&lt;/item&gt;</span>
<span class="w">    </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">id=</span><span class="s">"8348343"</span><span class="w"> </span><span class="na">ip=</span><span class="s">"10.12.37.24"</span><span class="w"> </span><span class="na">os=</span><span class="s">"linux"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;uri&gt;</span>http://test.com/example.php<span class="nt">&lt;/uri&gt;</span>
<span class="w">    </span><span class="nt">&lt;issue</span><span class="w"> </span><span class="na">severity=</span><span class="s">"low"</span><span class="nt">&gt;</span>Yet<span class="w"> </span>another<span class="w"> </span>vuln<span class="w"> </span>text<span class="nt">&lt;/issue&gt;</span>
<span class="w">    </span><span class="nt">&lt;/item&gt;</span>
<span class="w">    </span><span class="nt">&lt;statistics</span><span class="w"> </span><span class="na">elapsed=</span><span class="s">"402"</span><span class="w"> </span><span class="na">itemsfound=</span><span class="s">"3"</span><span class="w"> </span><span class="na">itemstested=</span><span class="s">"10"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/details&gt;</span>
<span class="nt">&lt;/example_tool&gt;</span>
</code></pre></div></p>
<p><strong>plugin.py</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>
<span class="kn">from</span> <span class="nn">faraday_plugins.plugins.plugin</span> <span class="kn">import</span> <span class="n">PluginXMLFormat</span>
<span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="k">as</span> <span class="nn">ET</span>

<span class="k">class</span> <span class="nc">ExampleToolXmlParser</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xml_output</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vulns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_xml</span><span class="p">(</span><span class="n">xml_output</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">parse_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xml_output</span><span class="p">):</span>
        <span class="n">vulns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">xml_output</span><span class="p">)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">iterfind</span><span class="p">(</span><span class="s1">'details/item'</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">ip</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'ip'</span><span class="p">)</span>
            <span class="n">os</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'os'</span><span class="p">)</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'uri'</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
            <span class="n">hostname</span> <span class="o">=</span> <span class="p">[</span><span class="n">url</span><span class="o">.</span><span class="n">netloc</span><span class="p">]</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">path</span>
            <span class="k">if</span> <span class="n">url</span><span class="o">.</span><span class="n">scheme</span> <span class="o">==</span> <span class="s1">'https'</span><span class="p">:</span>
                <span class="n">port</span> <span class="o">=</span> <span class="mi">443</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">port</span> <span class="o">=</span> <span class="mi">80</span>
            <span class="n">issue</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'issue'</span><span class="p">)</span>
            <span class="n">severity</span> <span class="o">=</span> <span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'severity'</span><span class="p">)</span>
            <span class="n">issue_text</span> <span class="o">=</span> <span class="n">issue</span><span class="o">.</span><span class="n">text</span>
            <span class="n">vuln</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'ip'</span><span class="p">:</span> <span class="n">ip</span><span class="p">,</span> <span class="s1">'uri'</span><span class="p">:</span> <span class="n">uri</span><span class="p">,</span> <span class="s1">'os'</span><span class="p">:</span> <span class="n">os</span><span class="p">,</span>
                    <span class="s1">'hostname'</span><span class="p">:</span> <span class="n">hostname</span><span class="p">,</span> <span class="s1">'port'</span><span class="p">:</span> <span class="n">port</span><span class="p">,</span> <span class="s1">'path'</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span>
                    <span class="s1">'issue_text'</span><span class="p">:</span> <span class="n">issue_text</span><span class="p">,</span> <span class="s1">'severity'</span><span class="p">:</span> <span class="n">severity</span><span class="p">}</span>
            <span class="n">vulns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vuln</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">vulns</span>


<span class="k">class</span> <span class="nc">ExampleToolPlugin</span><span class="p">(</span><span class="n">PluginXMLFormat</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">identifier_tag</span> <span class="o">=</span> <span class="s2">"example_tool"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="s2">"example_tool"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"Name of the tool"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugin_version</span> <span class="o">=</span> <span class="s2">"0.0.1"</span>

    <span class="k">def</span> <span class="nf">parseOutputString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ExampleToolXmlParser</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">vuln</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">vulns</span><span class="p">:</span>
            <span class="n">h_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createAndAddHost</span><span class="p">(</span><span class="n">vuln</span><span class="p">[</span><span class="s1">'ip'</span><span class="p">],</span> <span class="n">vuln</span><span class="p">[</span><span class="s1">'os'</span><span class="p">],</span> <span class="n">hostnames</span><span class="o">=</span><span class="n">vuln</span><span class="p">[</span><span class="s1">'hostname'</span><span class="p">])</span>
            <span class="n">s_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createAndAddServiceToHost</span><span class="p">(</span><span class="n">h_id</span><span class="p">,</span> <span class="s1">'webserver'</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="s1">'tcp'</span><span class="p">,</span> <span class="n">ports</span><span class="o">=</span><span class="n">vuln</span><span class="p">[</span><span class="s1">'port'</span><span class="p">])</span>
            <span class="n">v_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createAndAddVulnWebToService</span><span class="p">(</span><span class="n">h_id</span><span class="p">,</span> <span class="n">s_id</span><span class="p">,</span> <span class="n">vuln</span><span class="p">[</span><span class="s1">'issue_text'</span><span class="p">],</span> <span class="n">severity</span><span class="o">=</span><span class="n">vuln</span><span class="p">[</span><span class="s1">'severity'</span><span class="p">],</span>
                                                    <span class="n">path</span><span class="o">=</span><span class="n">vuln</span><span class="p">[</span><span class="s1">'path'</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">createPlugin</span><span class="p">(</span><span class="n">ignore_info</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hostname_resolution</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ExampleToolXmlParser</span><span class="p">(</span><span class="n">ignore_info</span><span class="o">=</span><span class="n">ignore_info</span><span class="p">)</span>
</code></pre></div>
<hr/>
<h4 id="test-and-debug">Test and Debug<a class="headerlink" href="#test-and-debug" title="Permanent link">¶</a></h4>
<p>You can test your plugin by enabling the custom_plugins_folder setting, and try it with faraday.</p>
<p>You can also test your plugin from the command line.</p>
<h5 id="test-plugins">Test Plugins<a class="headerlink" href="#test-plugins" title="Permanent link">¶</a></h5>
<p><strong>List all available plugins</strong></p>
<p>Verify that the plugins is loaded by the plugin manager</p>
<div class="highlight"><pre><span></span><code>faraday-plugins list-plugins

Available Plugins:
...
...
...
example_tool - Name of the tool
Loaded Plugins: 84
</code></pre></div>
<p><strong>Test plugin report detection</strong></p>
<p>Verify that your file is detected by your plugin</p>
<div class="highlight"><pre><span></span><code>faraday-plugins detect-report /path/to/report.xml

Plugin: example_tool
</code></pre></div>
<p><strong>Test plugin process report</strong></p>
<p>Verify that your plugin parses the file ok and generate the json structure that will be loaded into faraday</p>
<div class="highlight"><pre><span></span><code>faraday-plugins process-report /path/to/report.xml


{"hosts": [{"ip": "10.23.49.232", "os": "linux", "hostnames": ["test.com"], "description": "", "mac": null, "credentials": [], "services": [{"name": "webserver", "protocol": "tcp", "port": 80, "status": "open", "version": "unknown", "description": "", "credentials": [], "vulnerabilities": [{"name": "Some vuln text", "desc": "", "severity": "low", "refs": [], "external_id": null, "type": "VulnerabilityWeb", "resolution": "", "data": "", "website": "", "path": "/example.php", "request": "", "response": "", "method": "", "pname": "", "params": "", "query": "", "category": ""}]}], "vulnerabilities": [], "scan_template": "", "site_name": "", "site_importance": "", "risk_score": "", "fingerprints": "", "fingerprints_software": ""}, {"ip": "10.232.62.20", "os": "linux", "hostnames": ["test.com"], "description": "", "mac": null, "credentials": [], "services": [{"name": "webserver", "protocol": "tcp", "port": 80, "status": "open", "version": "unknown", "description": "", "credentials": [], "vulnerabilities": [{"name": "Some other text", "desc": "", "severity": "low", "refs": [], "external_id": null, "type": "VulnerabilityWeb", "resolution": "", "data": "", "website": "", "path": "/login.php", "request": "", "response": "", "method": "", "pname": "", "params": "", "query": "", "category": ""}]}], "vulnerabilities": [], "scan_template": "", "site_name": "", "site_importance": "", "risk_score": "", "fingerprints": "", "fingerprints_software": ""}, {"ip": "10.12.37.24", "os": "linux", "hostnames": ["test.com"], "description": "", "mac": null, "credentials": [], "services": [{"name": "webserver", "protocol": "tcp", "port": 80, "status": "open", "version": "unknown", "description": "", "credentials": [], "vulnerabilities": [{"name": "Yet another vuln text", "desc": "", "severity": "low", "refs": [], "external_id": null, "type": "VulnerabilityWeb", "resolution": "", "data": "", "website": "", "path": "/example.php", "request": "", "response": "", "method": "", "pname": "", "params": "", "query": "", "category": ""}]}], "vulnerabilities": [], "scan_template": "", "site_name": "", "site_importance": "", "risk_score": "", "fingerprints": "", "fingerprints_software": ""}], "command": {"tool": "example_tool", "command": "example_tool", "params": "/path/to/report.xml", "user": "faraday", "hostname": "", "start_date": "2020-04-01T18:43:34.552623", "duration": 2650, "import_source": "report"}}
</code></pre></div>
<p>You can optionally specify the plugin id to not do the detection step and force to process it with the specific plugin</p>
<div class="highlight"><pre><span></span><code>faraday-plugins process-report --plugin_id YourPluginId /path/to/report.xml


{"hosts": [{"ip": "10.23.49.232", "os": "linux", "hostnames": ["test.com"], "description": "", "mac": null, "credentials": [], "services": [{"name": "webserver", "protocol": "tcp", "port": 80, "status": "open", "version": "unknown", "description": "", "credentials": [], "vulnerabilities": [{"name": "Some vuln text", "desc": "", "severity": "low", "refs": [], "external_id": null, "type": "VulnerabilityWeb", "resolution": "", "data": "", "website": "", "path": "/example.php", "request": "", "response": "", "method": "", "pname": "", "params": "", "query": "", "category": ""}]}], "vulnerabilities": [], "scan_template": "", "site_name": "", "site_importance": "", "risk_score": "", "fingerprints": "", "fingerprints_software": ""}, {"ip": "10.232.62.20", "os": "linux", "hostnames": ["test.com"], "description": "", "mac": null, "credentials": [], "services": [{"name": "webserver", "protocol": "tcp", "port": 80, "status": "open", "version": "unknown", "description": "", "credentials": [], "vulnerabilities": [{"name": "Some other text", "desc": "", "severity": "low", "refs": [], "external_id": null, "type": "VulnerabilityWeb", "resolution": "", "data": "", "website": "", "path": "/login.php", "request": "", "response": "", "method": "", "pname": "", "params": "", "query": "", "category": ""}]}], "vulnerabilities": [], "scan_template": "", "site_name": "", "site_importance": "", "risk_score": "", "fingerprints": "", "fingerprints_software": ""}, {"ip": "10.12.37.24", "os": "linux", "hostnames": ["test.com"], "description": "", "mac": null, "credentials": [], "services": [{"name": "webserver", "protocol": "tcp", "port": 80, "status": "open", "version": "unknown", "description": "", "credentials": [], "vulnerabilities": [{"name": "Yet another vuln text", "desc": "", "severity": "low", "refs": [], "external_id": null, "type": "VulnerabilityWeb", "resolution": "", "data": "", "website": "", "path": "/example.php", "request": "", "response": "", "method": "", "pname": "", "params": "", "query": "", "category": ""}]}], "vulnerabilities": [], "scan_template": "", "site_name": "", "site_importance": "", "risk_score": "", "fingerprints": "", "fingerprints_software": ""}], "command": {"tool": "example_tool", "command": "example_tool", "params": "/path/to/report.xml", "user": "faraday", "hostname": "", "start_date": "2020-04-01T18:43:34.552623", "duration": 2650, "import_source": "report"}}
</code></pre></div>
<p>If you do not have faraday-server installed or don't have the custom_plugins_folder setting, you can use the <code>--custom_plugins_folder</code> parameter with any if the commands (list, detect and process)</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code>faraday-plugins list-plugins --custom-plugins-folder /home/user/.faraday/plugins/
</code></pre></div>
<h5 id="logging">Logging<a class="headerlink" href="#logging" title="Permanent link">¶</a></h5>
<p>In the <code>PluginBase</code> there is a logger defined in <code>self.logger</code> that you can use.</p>
<p>If you need to debug for plugins with the command line set this variable:</p>
<div class="highlight"><pre><span></span><code>export PLUGIN_DEBUG=1
faraday-plugins process-report appscan /path/to/report.xml
2019-11-15 20:37:03,355 - faraday.faraday_plugins.plugins.manager - INFO [manager.py:113 - _load_plugins()]  Loading Native Plugins...
2019-11-15 20:37:03,465 - faraday.faraday_plugins.plugins.manager - DEBUG [manager.py:123 - _load_plugins()]  Load Plugin [acunetix]
2019-11-15 20:37:03,495 - faraday.faraday_plugins.plugins.manager - DEBUG [manager.py:123 - _load_plugins()]  Load Plugin [amap]
2019-11-15 20:37:03,549 - faraday.faraday_plugins.plugins.manager - DEBUG [manager.py:123 - _load_plugins()]  Load Plugin [appscan]
2019-11-15 20:37:03,580 - faraday.faraday_plugins.plugins.manager - DEBUG [manager.py:123 - _load_plugins()]  Load Plugin [arachni]
2019-11-15 20:37:03,613 - faraday.faraday_plugins.plugins.manager - DEBUG [manager.py:123 - _load_plugins()]  Load Plugin [arp_scan]
2019-11-15 20:37:03,684 - faraday.faraday_plugins.plugins.manager - DEBUG [manager.py:123 - _load_plugins()]  Load Plugin [beef]
2019-11-15 20:37:03,714 - faraday.faraday_plugins.plugins.manager - DEBUG [manager.py:123 - _load_plugins()]  Load Plugin [brutexss]
2019-11-15 20:37:03,917 - faraday.faraday_plugins.plugins.manager - DEBUG [manager.py:123 - _load_plugins()]  Load Plugin [burp]
2019-11-15 20:37:03,940 - faraday.faraday_plugins.plugins.manager - DEBUG [manager.py:123 - _load_plugins()]  Load Plugin [dig]
...
</code></pre></div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/infobyte/faraday/" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</a>
<a class="md-social__link" href="https://twitter.com/faradaysec" rel="noopener" target="_blank" title="twitter.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg>
</a>
<a class="md-social__link" href="https://www.linkedin.com/company/faradaysec/" rel="noopener" target="_blank" title="www.linkedin.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg>
</a>
<a class="md-social__link" href="https://instagram.com/faradaysec" rel="noopener" target="_blank" title="instagram.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../assets/javascripts/bundle.b4d07000.min.js"></script>
<script src="https://unpkg.com/mermaid@8.5.1/dist/mermaid.min.js"></script>
<script>document$.subscribe(() => {
            window.update_swagger_ui_iframe_height = function (id) {
                var iFrameID = document.getElementById(id);
                if (iFrameID) {
                    full_height = (iFrameID.contentWindow.document.body.scrollHeight + 80) + "px";
                    iFrameID.height = full_height;
                    iFrameID.style.height = full_height;
                }
            }
        
            let iframe_id_list = []
            var iframes = document.getElementsByClassName("swagger-ui-iframe");
            for (var i = 0; i < iframes.length; i++) { 
                iframe_id_list.push(iframes[i].getAttribute("id"))
            }
        
            let ticking = true;
            
            document.addEventListener('scroll', function(e) {
                if (!ticking) {
                    window.requestAnimationFrame(()=> {
                        let half_vh = window.innerHeight/2;
                        for(var i = 0; i < iframe_id_list.length; i++) {
                            let element = document.getElementById(iframe_id_list[i])
                            if(element==null){
                                return
                            }
                            let diff = element.getBoundingClientRect().top
                            if(element.contentWindow.update_top_val){
                                element.contentWindow.update_top_val(half_vh - diff)
                            }
                        }
                        ticking = false;
                    });
                    ticking = true;
                }
            });
        
            const dark_scheme_name = "slate"
            
            window.scheme = document.body.getAttribute("data-md-color-scheme")
            const options = {
                attributeFilter: ['data-md-color-scheme'],
            };
            function color_scheme_callback(mutations) {
                for (let mutation of mutations) {
                    if (mutation.attributeName === "data-md-color-scheme") {
                        scheme = document.body.getAttribute("data-md-color-scheme")
                        var iframe_list = document.getElementsByClassName("swagger-ui-iframe")
                        for(var i = 0; i < iframe_list.length; i++) {
                            var ele = iframe_list.item(i);
                            if (ele) {
                                if (scheme === dark_scheme_name) {
                                    ele.contentWindow.enable_dark_mode();
                                } else {
                                    ele.contentWindow.disable_dark_mode();
                                }
                            }
                        }
                    }
                }
            }
            observer = new MutationObserver(color_scheme_callback);
            observer.observe(document.body, options);
            })</script></body>
</html>